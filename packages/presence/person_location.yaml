
proximity:
  matt_from_home:
    zone: home
    tolerance: 50
    unit_of_measurement: mi
    devices: person.matt
  sarah_from_home:
    zone: home
    tolerance: 50
    unit_of_measurement: mi
    devices: person.sarah

sensor:
  - platform: template
    sensors:
      # people_home:
      #   friendly_name: People Home
      #   value_template: >-
      #     {{ states.person | selectattr( 'state', 'eq', 'home') | list | length }}

      matt_friendly_location:
        friendly_name: Matt Friendly Location
        value_template: >
          {% if states.person.matt.state == 'home' %}
          Home
          {% elif (states.proximity.matt_from_home.state|float >= 70) and (states.proximity.matt_from_home.state|float <= 200) %}
          Lost
          {% elif states.proximity.matt_from_home.state|float > 200 %}
          Far Away
          {% elif states.person.matt.state == 'Matt Work' %}
          Work
          {% else %}
          nr. {{states.sensor.matts_iphone_geocoded_location.attributes.Thoroughfare}}
          {% endif %}

      sarah_friendly_location:
        friendly_name: Sarah Friendly Location
        value_template: >
          {% if states.person.sarah.state == 'home' %}
          Home
          {% elif (states.proximity.sarah_from_home.state|float >= 70) and (states.proximity.sarah_from_home.state|float <= 200) %}
          Lost
          {% elif states.proximity.sarah_from_home.state|float > 200 %}
          Far Away
          {% elif states.person.sarah.state == 'Sarah Work' %}
          Work
          {% else %}
          nr. {{states.sensor.sarahs_iphone_geocoded_location.attributes.Thoroughfare}}
          {% endif %}
